import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css             *//* empty css                        */import"./api.client-Cwoejsn1.js";import{M as T}from"./main-FYAW3UC_.js";const E=document.getElementById("grid"),d=document.getElementById("status"),C=document.getElementById("limitInput"),L=document.getElementById("reloadBtn");let v=parseInt(C.value,10)||12;function g(t){if(!t)return null;if(typeof t=="string")return t;const e=Object.keys(t);for(const n of["en","en-us","en-gb","uk","ru"])if(t[n])return t[n];return t[e[0]]}function y(t){return String(t||"").replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[e])}function N(t,e=260){return t?t.length>e?t.slice(0,e).trim()+"...":t:""}async function w(t){E.innerHTML="";const e=[];for(const n of t){const o=n.id,r=n.attributes||{},a=g(r.title)||"(–ë–µ–∑ –Ω–∞–∑–≤–∏)",s=r.altTitles&&r.altTitles.length?g(r.altTitles[0]):"",p=g(r.description)||"",$=(r.tags||[]).map(c=>c?.attributes?.name&&g(c.attributes.name)||"").filter(Boolean),i=document.createElement("article");i.className="card";const m=document.createElement("img");m.className="thumb",m.alt=a,m.src="/css/placeholder.png";const u=document.createElement("div");u.className="meta",u.innerHTML=`
        <div class="title">${y(a)}</div>
        <div class="subtitle">${y(s)}</div>
        <div class="desc">${y(N(p,300))}</div>
      `;const f=document.createElement("div");f.className="tags";for(const c of $){const l=document.createElement("div");l.className="tag",l.textContent=c,f.appendChild(l)}u.appendChild(f),i.appendChild(m),i.appendChild(u),i.style.cursor="pointer",i.addEventListener("click",()=>{window.location.href=`/manga.html?id=${encodeURIComponent(o)}`}),E.appendChild(i);const h=(n.relationships||[]).find(c=>c.type==="cover_art");if(h&&h.id){const c=T.callProxy(`/cover/${h.id}`).then(l=>{const I=(l?.data||l)?.attributes?.fileName;I&&(m.src=`https://uploads.mangadex.org/covers/${o}/${I}`)}).catch(()=>{});e.push(c)}}await Promise.allSettled(e),R()}function R(){document.querySelectorAll(".tags").forEach(t=>{const e=Array.from(t.querySelectorAll(".tag")),n=4;if(e.length<=n)return;const o=e.slice(n);o.forEach(s=>{s.style.display="none"});const r=o.length,a=document.createElement("div");a.className="tag-more",a.textContent=`+${r}`,t.appendChild(a)})}async function x(){try{v=parseInt(C.value,10)||12,d.textContent="–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π...",E.innerHTML="";const t=await apiFetch(`/api/history/recomendation-vector?limit=${v}`,{method:"GET"}),e=Array.isArray(t)?t:t?.items||[];if(!e.length){d.textContent="–ü–æ–∫–∏ –Ω–µ–º–∞—î —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π. –ü–æ—á–Ω—ñ—Ç—å —á–∏—Ç–∞—Ç–∏ –º–∞–Ω“ë—É üôÇ";return}const n=e.filter(s=>s.genreId).sort((s,p)=>p.number-s.number).slice(0,2).map(s=>s.genreId);if(!n.length){d.textContent="–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –∂–∞–Ω—Ä–∏ –∑ —ñ—Å—Ç–æ—Ä—ñ—ó.";return}const o={"includedTags[]":n,includedTagsMode:"OR","contentRating[]":["safe","suggestive"],"order[relevance]":"desc",limit:v},a=(await T.callProxy("/manga",o,{method:"GET"}))?.data||[];if(!a.length){d.textContent="–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –º–∞–Ω“ë–∏ –∑–∞ –≤–∞—à–∏–º–∏ –≤–ø–æ–¥–æ–±–∞–Ω–Ω—è–º–∏.";return}d.textContent=`–ó–Ω–∞–π–¥–µ–Ω–æ ${a.length} —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π`,await w(a)}catch(t){console.error("Recommendations error:",t),d.textContent="–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π: "+(t.message||t)}}L.addEventListener("click",x);C.addEventListener("change",x);x();
