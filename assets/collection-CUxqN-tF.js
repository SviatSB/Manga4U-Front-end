import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css             */import"./header.init-DNZ4xaCr.js";import"./api.client-Cwoejsn1.js";function u(t){const e=location.search.match(new RegExp("[?&]"+t+"=([^&]+)"));return e?decodeURIComponent(e[1]):null}const o=u("id"),l=document.getElementById("colName"),s=document.getElementById("collectionActions"),r=document.getElementById("mangaList");let m=!1,d=!1;async function p(t){try{const n=(await(await fetch(`https://api.mangadex.org/cover?manga[]=${t}&limit=1`)).json())?.data?.[0];if(!n)return"/css/placeholder.png";const c=n.attributes.fileName;return`https://uploads.mangadex.org/covers/${t}/${c}`}catch{return"/css/placeholder.png"}}async function i(){if(o)try{const t=await apiFetch(`/api/Collection/${o}`);l.textContent=t.name,m=t.systemCollectionType!==null,d=t.isOwner??!1,f(t),h(t.mangas||[])}catch(t){console.error(t),l.textContent="–ö–æ–ª–µ–∫—Ü—ñ—è –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞"}}function f(t){if(s.innerHTML="",!t.isOwner||m)return;const e=document.createElement("button");e.className="btn-small",e.textContent="‚úè –ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏",e.onclick=async()=>{const c=prompt("–ù–æ–≤–∞ –Ω–∞–∑–≤–∞:");c&&(await apiFetch(`/api/Collection/${o}/rename`,{method:"POST",body:c}),i())};const a=document.createElement("button");a.className="btn-small",a.textContent=t.isPublic?"üëÅ –ó—Ä–æ–±–∏—Ç–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—é":"üëÅ –ó—Ä–æ–±–∏—Ç–∏ –ø—É–±–ª—ñ—á–Ω–æ—é",a.onclick=async()=>{await apiFetch(`/api/Collection/${o}/visibility`,{method:"POST",body:JSON.stringify(!t.isPublic)}),i()};const n=document.createElement("button");n.className="btn-small btn-danger",n.textContent="üóë –í–∏–¥–∞–ª–∏—Ç–∏",n.onclick=async()=>{confirm("–í–∏–¥–∞–ª–∏—Ç–∏ –∫–æ–ª–µ–∫—Ü—ñ—é?")&&(await apiFetch(`/api/Collection/${o}`,{method:"DELETE"}),window.location.href="/collections.html")},s.append(e,a,n)}async function h(t){r.innerHTML="";for(const e of t){const a=await p(e.externalId),n=document.createElement("div");n.className="collection-card",n.innerHTML=`
            <!-- –ò–∫–æ–Ω–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è -->
            <button class="remove-icon" data-id="${e.externalId}" title="–í–∏–¥–∞–ª–∏—Ç–∏">üóë</button>

            <!-- –ö–ª–∏–∫–∞–±–µ–ª—å–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –º–∞–Ω–≥—É -->
            <a class="collection-card__link" href="/manga.html?id=${e.externalId}">
                <img class="collection-cover" src="${a}" alt="${e.name}">
                <div class="collection-title">${e.name}</div>
            </a>

            ${d?`<button class="mini-btn remove" data-id="${e.externalId}">–í–∏–ª—É—á–∏—Ç–∏</button>`:""}
        `,r.appendChild(n)}}document.addEventListener("click",async t=>{const e=t.target.closest(".remove-icon, .remove");if(!e)return;t.preventDefault(),t.stopPropagation();const a=e.dataset.id;try{await apiFetch(`/api/Collection/${o}/manga?mangaExternalId=${a}`,{method:"DELETE"}),await i()}catch(n){console.error("–ü–æ–º–∏–ª–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –º–∞–Ω“ë–∏:",n),alert("–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–¥–∞–ª–∏—Ç–∏ –º–∞–Ω“ë—É")}});i();
