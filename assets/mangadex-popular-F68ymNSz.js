import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css             */import"./api.client-Cwoejsn1.js";import{M as $}from"./main-FYAW3UC_.js";const C=document.getElementById("grid"),y=document.getElementById("status"),N=document.getElementById("prev"),B=document.getElementById("next"),T=document.getElementById("pageDisplay"),I=document.getElementById("limitInput");let i=1,E=parseInt(I.value,10)||24,x=1;function u(t){if(!t)return null;if(typeof t=="string")return t;const e=Object.keys(t);for(const n of["en","en-us","en-gb"])if(t[n])return t[n];return t[e[0]]}function P(t,e=260){return t?t.length>e?t.slice(0,e).trim()+"...":t:""}async function k(t){C.innerHTML="";const e=[];for(const n of t){const a=n.id,s=n.attributes||{},r=u(s.title)||"(No title)",f=s.altTitles&&s.altTitles.length?u(s.altTitles[0]):"",S=u(s.description)||"",M=(s.tags||[]).map(c=>c?.attributes?.name&&u(c.attributes.name)||"").filter(Boolean),o=document.createElement("article");o.className="card";const d=document.createElement("img");d.className="thumb",d.alt=r,d.src="/css/placeholder.png";const m=document.createElement("div");m.className="meta",m.innerHTML=`
      <div class="title">${p(r)}</div>
      <div class="subtitle">${p(f)}</div>
      <div class="desc">${p(P(S,300))}</div>
    `;const h=document.createElement("div");h.className="tags";for(const c of M){const l=document.createElement("div");l.className="tag",l.textContent=c,h.appendChild(l)}m.appendChild(h),o.appendChild(d),o.appendChild(m),o.style.cursor="pointer",o.addEventListener("click",()=>{window.location.href=`/manga.html?id=${encodeURIComponent(a)}`}),C.appendChild(o);const v=(n.relationships||[]).find(c=>c.type==="cover_art");if(v&&v.id){const c=$.callProxy(`/cover/${v.id}`).then(l=>{const L=(l?.data||l)?.attributes?.fileName;L&&(d.src=`https://uploads.mangadex.org/covers/${a}/${L}`)}).catch(()=>{});e.push(c)}}await Promise.allSettled(e),w()}function p(t){return String(t||"").replace(/[&<>"']/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[e])}function w(){document.querySelectorAll(".tags").forEach(t=>{const e=Array.from(t.querySelectorAll(".tag")),n=4;if(e.length<=n)return;const a=e.slice(n);a.forEach(f=>f.style.display="none");const s=a.length,r=document.createElement("div");r.className="tag-more",r.textContent=`+${s}`,t.appendChild(r)})}async function g(t=1){try{E=parseInt(I.value,10)||24,y.textContent="Завантаження...";const e=await $.getPopular(t,E),n=e?.data||[],a=e?.total||n.length||0;x=Math.max(1,Math.ceil(a/E)),i=t,T.textContent=String(i),N.disabled=i<=1,B.disabled=i>=x,y.textContent=n.length?`Показано ${n.length} з ${a}`:"Немає результатів",await k(n)}catch(e){y.textContent="Помилка: "+(e.message||e),C.innerHTML="<pre>"+p(String(e))+"</pre>"}}N.addEventListener("click",()=>{i>1&&g(i-1)});B.addEventListener("click",()=>{i<x&&g(i+1)});I.addEventListener("change",()=>g(1));g(1);
